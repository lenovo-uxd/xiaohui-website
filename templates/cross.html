<!DOCTYPE html>
<html lang="ch">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>跨域转换</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cross.css')}}">
<<<<<<< Updated upstream
    <script src="{{ url_for('static', filename='js/jquery.min.js')}}">
=======
    <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='image/favicon.png')}}">
    <script src="https://code.jquery.com/jquery-1.8.3.min.js">
>>>>>>> Stashed changes
    </script>
    
    
</head>

<body>
<!--页面信息-->
<div id="landing">
<div id="back"><img src="{{ url_for('static', filename='image/human1.png')}}"/></div>
<div id="front"> </div>
<div id="mask"><img src="{{ url_for('static', filename='image/human2.png')}}"/></div>
</div>
<div id="title">
<h1>时光机-跨域转换</h1>
<p>通过深度学习，实现头像素材从一个风格域到另一个风格域的跨域转换。</p>
<button id="gotoTry">试试看</button>
</div>
<!--向下滚-->
<div id="scroll">
<div id="pro">

<div id="proSub">
<div class="proSub1">
<div id="proicon1">
<div class="icon1"></div><div class="icon2"></div><div class="icon3"></div><div class="icon4"></div> 
</div>
<div class="proh3"><h3>神形兼备</h3></div>
<div class="prop"><p>既保留本体形态,又兼顾转换风格特征。</p></div>
</div>
<div class="proSub1">
<div id="proicon2">
<div class="icon1"></div><div class="icon2"></div><div class="icon3"></div><div class="icon4"></div>     
</div>
<div class="proh3"><h3>随心所域</h3></div>
<div class="prop"><p>头像跨次元,时空及多领域智能转换。</p></div> 
</div>
<div class="proSub1">
<div id="proicon3">
<div class="icon1"></div>
<div class="icon2">
    <video width="100%" height="100%" autoplay muted loop>
        <source src="{{ url_for('static', filename='image/yaocen1.mp4')}}" type="video/mp4">
    </video>
</div>
<div class="icon3">
    <video width="100%" height="100%" autoplay muted loop>
        <source src="{{ url_for('static', filename='image/yaocen.mp4')}}" type="video/mp4">
    </video>
</div>
</div>
<div class="proh3"><h3>实时转换</h3></div>
<div class="prop"><p>支持图片速转及视频流实时转换。</p></div>
</div>
</div>
</div>
    
<!--能力演示-->
<div id="studyProcess">
<div class="mainInfo" id="studyInfo">
<div><h1>能力演示</h1></div>
<div><p>选择头像体验跨域转换能力，该能力演示基于<a href="#">跨域转换API</a>搭建，
如果您对技术能力有特别要求，欢迎联系我们。</p></div>
</div>
<div id="tryAbility"> 
<div class="sideByside1">
<div id="before">
<div><p>原图</p></div>
</div>
<div id="upload">
<div class="originpic1"><div id="originpic1"><p>例1</p></div></div>
<div class="originpic2"><div id="originpic2"><p>例2</p></div></div> 

<input type="file" id="myFile" accept="image/jpeg,image/png,image/jpg" name="filename" onchange="changepic(this,event,1)">
<label for="myFile" id="inputLabel">上传头像</label>
    
</div>
</div> 

<div class="sideByside2">
<div id="after">
<div><p>效果</p></div>    
</div>
<div id="styleChoose">
<div class="style1"><div id="style1"><p>中世纪</p></div></div>
    
</div> 
</div>     
</div>   

</div>
    
<!--应用案例-->
<div id="case">
<div class="mainInfo" id="caseInfo">
<div><h1>应用案例</h1></div>
<div><p>可用于制作静态或动态头像</p></div>
</div>
<div class="pic" id="pic4">
<div id="crosscase1"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase2"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase3"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase4"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase5"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase6"><div class="casebefore"></div><div class="caseafter"></div></div> 
<div id="crosscase7"><div class="casebefore"></div><div class="caseafter"></div></div> 
</div>
</div>
<!--其他能力-->
<div id="more">
<div class="mainInfo" id="moreInfo">
<div><h1>尝试其他小绘智能设计能力</h1></div>
</div>
<div id="moreSub">
    
<div onclick="window.location.href= '/gdesign';return false">
<div class="othericon"></div>
<div><h3>望远镜</h3><p>背景拓展工具</p></div>
<div></div>
</div>
    
<div onclick="window.location.href= '/transfer';return false">
<div class="othericon"></div>
<div><h3>万花筒</h3><p>风格迁移工具</p></div>
</div>
    
</div>
</div>
    
<!--页脚-->
<div id="footer"> 
<div id="leftSide">
<div></div>
<p id="groupName">联想研究院用户体验设计</p> 
<p id="email">联系邮箱：yangzhi3@lenovo.com</p>

</div>   
<div id="rightSide">
<p>关注公众号“联想研究院UXD”<br>获取更多有趣的资讯~</p>
<div></div>
</div> 
</div>
<div id="line"></div>
<div id="middleSide"><p><span>Made with</span> 🧡❤️🧡❤️🧡❤️🧡 <span>by UXD Lenovo Research</span></p></div>  
</div>
<!--不动产-->
<div id="navback"></div>
<div class="nav">
      
        <div class="logo">
                <a href="/">
                <img src="{{ url_for('static', filename='image/logowhite.svg')}}" width=100% height=auto />
                </a>
        </div>
        
        <nav class="dropdownmenu">
        <ul>
        <li><a href="/" class="mainMenu">主页</a></li>
        <li id="gdesign"><a href="#" class="mainMenu">能力展示</a>
        <ul id="submenu">
        <li><a href="/gdesign">望远镜</a></li>
        <li><a href="/transfer">万花筒</a></li>
        <li><a href="/cross">时光机</a></li>
        </ul>
        </li>
        <li><a href="#" class="mainMenu">API接入</a></li>
        <li><a href="/about" class="mainMenu">关于我</a></li>
        </ul>
        </nav>
            
        <div class="english">
         <a href="#">
         <p>EN</p>
         </a>
        </div>
        </div>

    
<!--js代码-->
<script type="text/javascript"> 
    //赋值变量
    var tryPosition = $('#studyProcess').offset().top;
    var casePosition= $('#case').offset().top;
    var oBox = document.getElementById('mask'),
        windowTop=0,
        windowH=window.innerHeight,
        proDiv=document.getElementById("pro"),
        proH=proDiv.offsetHeight,
        videoH=document.getElementById("studyProcess").offsetHeight,
        leftdownHint=$(".leftdown div"),
        scrolldiv=document.getElementsByClassName("flexslider"),
        leftdownSvg=$(".leftdown svg g g "),
        contactSvg=$(".contact svg g g "),
        logoChange=$("#logoChange g g"),
        english=$(".english a"),
        mainMenu=$(".mainMenu"),
        normalGray="#444553",
        whiteColor="white",
        contact=$(".contact"),
        leftDown=$(".leftdown"),
        flexslider=$(".flexslider"),
        qrcode=$(".qrcode"),
        qrcodeP=$(".qrcode p"),
        timeSpace=500;
    //页面加载
    window.onload=function(){
        /*点击试试看页面滑动*/
        $("#title button").on("click",function(){
            window.scrollTo({ 
            top: tryPosition, 
            behavior: "smooth" 
        });
        })
        
        //鼠标悬停
        contact.mouseenter(
                function () {
                    qrcode.css("width","20rem").css("height","24rem");
                    qrcodeP.css("opacity","1");
                    contact.css("opacity","1");
                });
        contact.mouseleave(
                function () {
                    qrcode.css("width","0rem").css("height","0rem");
                    qrcodeP.css("opacity","0");
                    contact.css("opacity","0.8");
                });
        leftDown.mouseenter(
                function () {
                    leftdownHint.css("opacity",1);
                });
        leftDown.mouseleave(
                function () {
                    leftdownHint.css("opacity",0);
                });
        slider(flexslider,4,160*0.6);
        
        //探照灯
        window.onmousemove = function(e){
        e = e || event;
        oBox.style.WebkitMaskPosition=(e.clientX-350)+"px "+ (e.clientY-350)+"px";
        }
        
        //走马灯
        function slider(who,totalSlides,width){
        var currentSlide=1;
        var interval;
        function startslide(){
        interval=setInterval(function(){
        who.animate({'margin-left':'-='+width+'rem'},timeSpace*2,function(){
        currentSlide++;
            if(currentSlide==totalSlides){
                currentSlide=1;
                who.css("margin-left",0);
            }
        });
        },3000);}
        function pauseslide(){
        clearInterval(interval);
        }
        $(".box").on("mouseenter",pauseslide).on("mouseleave",startslide);
        startslide();
        };
        
         // 上下滑动
        $(window).scroll(function() {
        let scrollS = $(this).scrollTop();
        //导航变化
        if(scrollS>10){
        $(".nav").css("top","9px");// 上滑时要做的事（上移一点）
        $("#navback").css("opacity","1");   
        }else{
        $(".nav").css("top","30px");// 上滑时要做的事（上移一点）
        $("#navback").css("opacity","0");  
        }
        //滚动页面动效
        var disappear=1-(scrollS/windowH)*2;
        $("#title").css("opacity",disappear);
        var coverOpacity=((scrollS-(proH+windowH))/windowH);
        $("#videoCover").css("opacity",coverOpacity); 

        //case微动
        var tryHeight=$("#demo").height();
        
        if(scrollS>tryPosition+tryHeight-windowH){
            var caseMove=(scrollS-casePosition)*(1/windowH)*130;
            $("#crosscase1").css("transform","translateY("+caseMove+"px)");
            $("#crosscase3").css("transform","translateY("+caseMove+"px)");
            $("#crosscase5").css("transform","translateY("+caseMove+"px)");
            $("#crosscase7").css("transform","translateY("+caseMove+"px)");
        }
        //图形元素微动
        
        var pM=scrollS*0.05; 
        $("#proicon1 .icon1").css("transform","translateY("+(-pM)+"px)");
        $("#proicon1 .icon2").css("transform","translate("+(-pM)+"px,"+(-pM)+"px)");
        $("#proicon1 .icon3").css("transform","translate("+pM/2+"px,"+pM+"px)");
        $("#proicon1 .icon4").css("transform","translate("+pM/2+"px,"+pM+"px)");
        var maskSize="calc(6vw + "+(pM*1.5)+"px) calc(11vw + "+(-pM*2)+"px)";
        // console.log(maskSize);
        $("#proicon1 .icon4").css("-webkit-mask-size",maskSize);
        
        $("#proicon2 .icon1").css("transform","translateY("+(-pM/2)+"px)");
        $("#proicon2 .icon2").css("transform","translate("+(-pM/2)+"px,"+pM/2+"px)");
        $("#proicon2 .icon3").css("transform","translate("+pM/2+"px,"+pM/2+"px)");
        // $("#proicon2 .icon4").css("transform","translate("+pM/2+"px,"+pM/2+"px)");
            
        $("#proicon3 .icon1").css("transform","translate("+(-pM/2)+"px,"+pM+"px)");
        $("#proicon3 .icon2").css("transform","translate("+(-pM/2)+"px,"+pM+"px)");
        $("#proicon3 .icon3").css("transform","translate("+pM/2+"px,"+(-pM)+"px)");
        
        
       
        });
    }
    
      //表单部分
    
    var camp="{{ url_for('static', filename='image/man1.png')}}";
    var scooter="{{ url_for('static', filename='image/woman1.png')}}";
  
    var camp1="{{ url_for('static', filename='image/man2.png')}}";
    var scooter1="{{ url_for('static', filename='image/woman2.png')}}";
  
    
    //切换已有原图
    styleChange(camp1);
    $("#originpic1").click(function(){
        changePlaceholder(camp,camp1);
        styleChange(camp1);
        styleBorder("#originpic",1,3);
    });
    $("#originpic2").click(function(){
        changePlaceholder(scooter,scooter1);
        styleChange(scooter1);
        styleBorder("#originpic",2,3);
    });
    $("#originpic1").trigger("click");
    
    
    
    /*var imgbase;*/
    function changepic(obj,event,styleName) {
        var newsrc=getObjectURL(obj.files[0]);
        $("#before").css("backgroundImage","url("+newsrc+")");
        //base64转换
        var file = event.target.files[0];
        var reader = new FileReader();
        reader.onload = function(event) {
        var imgbase=event.target.result;
        var imgbaseBack=imgbase.split(",")[1];
        var imgbaseFront=imgbase.split(",")[0]
        var imgInfo={
            "Base64Data":imgbaseBack,
            "gender": "mix",
            "domain":"medieval"
        };
            
        // console.log(imgInfo);
            
        //post给服务器
        $.ajax({
            type:'POST',
            url:'/cross-domain',
            contentType:'application/json',
            data:JSON.stringify(imgInfo),
            dataType:'json',
            success:function(data){
            var finaldata=imgbaseFront+","+data.result;
            $("#after").css("backgroundImage","url("+finaldata+")"); 
            console.log(finaldata);
            },
            error:function(err){
            console.log(err);
            },
        });
        };
        reader.readAsDataURL(file);
        
        
    }

   
    
    //建立一個可存取到該file的url
    function getObjectURL(file) {
        var url = null ;
        // 下面函数执行的效果是一样的，只是需要针对不同的浏览器执行不同的 js 函数而已
        if (window.createObjectURL!=undefined) { // basic
            url = window.createObjectURL(file) ;
            } else if (window.URL!=undefined) { // mozilla(firefox)
            url = window.URL.createObjectURL(file) ;
            } else if (window.webkitURL!=undefined) { // webkit or chrome
            url = window.webkitURL.createObjectURL(file) ;
            }
            return url ;
    }
    
    //按钮状态改变
    function styleBorder(which,num,total){
        for(i=1;i<=total;i++){
            if(i==num){
            $(which+i).css("border","3px solid #5376FF");
            }else{
            $(which+i).css("border","none"); 
            }
        }  
    }
    
    //切换风格图
    function styleChange(sty1){
        
        
        $("#style1").click(function(){/*$("#after").css("backgroundImage","url("+sty1+")");*/
         styleBorder("#style",1,5);                      
                                     });
       
        
        $("#style1").trigger("click");
        };
    
    //替换占位图
    function changePlaceholder(toWhat,which){
        $("#before").css("backgroundImage","url("+toWhat+")");
        $("#after").css("backgroundImage","url("+which+")");
    }
    
    
    var caseHeight1=document.getElementById("crosscase2").clientWidth;
    var caseHeight2=document.getElementById("crosscase4").clientWidth;
    var caseHeight3=document.getElementById("crosscase6").clientWidth;
    
    start($("#crosscase2 .casebefore"),caseHeight1);
    start($("#crosscase2 .caseafter"),caseHeight1);
    
    start($("#crosscase4 .casebefore"),caseHeight2);
    start($("#crosscase4 .caseafter"),caseHeight2);
    
    start($("#crosscase6 .casebefore"),caseHeight3);
    start($("#crosscase6 .caseafter"),caseHeight3);
    //序列帧动画（div，每次动多少，多少张）
    function start(aniPosition,step){
        var i=0;
        setInterval(
        function(){
            
            i += -step;
            aniPosition.css('background-position',"0px " + i + "px");
            
        }, 70);}
</script> 
</body>
  
    
   

</html>